"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[725],{8725:(O,v,c)=>{c.d(v,{R:()=>q});var l=c(4999),r=c(8966);class x{constructor(n){this.id=n.id,this.type_documents=n.type_documents,this.libelle_document=n.libelle_document,this.parent_id=n.parent_id,this.file_name=n.file_name,this.updated_by=n.updated_by,this.created_by=n.created_by,this.updated_at=n.updated_at,this.created_at=n.created_at,this.deleted_at=n.deleted_at}}var t=c(5e3),m=c(3075),b=c(5384);let p=(()=>{class i{constructor(e){this.apiService=e}getAll(){return this.apiService.get("api/media")}delete(e){return this.apiService.delete("api/media/"+e.id)}getMediaByTypeAndId(e){return this.apiService.post("api/media/getMediaByTypeAndId",e)}add(e,o){let a=o,d=new FormData;d.append("uploadFile",a,a.name),d.append("media",JSON.stringify(e));let s=new Headers;return s.append("Content-Type","multipart/form-data"),s.append("Accept","application/json"),this.apiService.post3("api/media",d,{headers:s})}update(e){return this.apiService.put("api/media/"+e.id,e)}get(e){return this.apiService.get("api/media/"+e)}getDocument(e){return this.apiService.get2("api/media/getDocument/"+e)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(b.s))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var f=c(7261),_=c(7322),C=c(7531),h=c(7423),u=c(9808),g=c(5245);const y=["avatarFileInput"];function Z(i,n){1&i&&t._UZ(0,"mat-icon",14)}let T=(()=>{class i{constructor(e,o,a,d,s){this._formBuilder=e,this._data=o,this.matDialogRef=a,this.mediaService=d,this._snackBar=s,this.data={},this.action="new",this.formFieldHelpers=[""],this.media=new x(o.media),this.mediaForm=this.createMediaForm()}ngOnInit(){}createMediaForm(){return this._formBuilder.group({id:[this.media.id],parent_id:[this.media.parent_id],type_documents:[this.media.type_documents],libelle_document:[this.media.libelle_document],fichier:[this.media.id]})}onSubmit(e){if(!e.length)return;const o=["image/jpeg","image/png","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],a=e[0];if(!o.includes(a.type))return void this._snackBar.open(a.type+" Cette extension n'est pas prise en charge "+o,"Splash",{horizontalPosition:"right",verticalPosition:"top",duration:12e3});this.data.btnsubmit=!0;let d=this.mediaForm.getRawValue();this.mediaService.add(d,a).subscribe(s=>{this.data.btnsubmit=!1,this._snackBar.open("Votre document a \xe9t\xe9 sauvegard\xe9","Splash",{horizontalPosition:"right",verticalPosition:"top",duration:2e3}),this.matDialogRef.close(this.mediaForm)},s=>{console.log(s),this.data.btnsubmit=!1})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.qu),t.Y36(r.WI),t.Y36(r.so),t.Y36(p),t.Y36(f.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-media-add"]],viewQuery:function(e,o){if(1&e&&t.Gf(y,5),2&e){let a;t.iGM(a=t.CRH())&&(o._avatarFileInput=a.first)}},inputs:{name:"name"},decls:21,vars:6,consts:[["mat-dialog-title",""],[1,"sm:p-6","w-200"],[1,"",3,"formGroup"],[1,"flex","flex-col","w-full"],[1,"flex"],[1,"w-full"],["matInput","","required","",3,"formControlName"],[1,"flex","flex-col"],["id","file-input","type","file",1,"w-full",3,"multiple"],["docFileInput",""],["align","end"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],["mat-button","",3,"disabled","click"],["style","color: white;","svgIcon","iconsmind:refresh","class","animate-spin-slow",4,"ngIf"],["svgIcon","iconsmind:refresh",1,"animate-spin-slow",2,"color","white"]],template:function(e,o){if(1&e){const a=t.EpF();t.TgZ(0,"h2",0),t._uU(1,"Ajouter un document"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),t._uU(8,"Libelle document"),t.qZA(),t._UZ(9,"input",6),t.qZA()(),t.TgZ(10,"div",7)(11,"mat-label"),t._uU(12,"Fichier joint"),t.qZA(),t._UZ(13,"input",8,9),t.qZA()()()(),t.TgZ(15,"mat-dialog-actions",10)(16,"button",11),t._uU(17,"Annuler"),t.qZA(),t.TgZ(18,"button",12),t.NdJ("click",function(){t.CHM(a);const s=t.MAs(14);return o.onSubmit(s.files)}),t.YNc(19,Z,1,0,"mat-icon",13),t._uU(20),t.qZA()()}2&e&&(t.xp6(3),t.Q6J("formGroup",o.mediaForm),t.xp6(6),t.Q6J("formControlName","libelle_document"),t.xp6(4),t.Q6J("multiple",!1),t.xp6(5),t.Q6J("disabled",!o.mediaForm.valid),t.xp6(1),t.Q6J("ngIf",o.data.btnsubmit),t.xp6(1),t.hij(" \xa0 ","new"==o.action?"Enregister":"Modifier",""))},directives:[r.uh,r.xY,m._Y,m.JL,m.sg,_.KE,_.hX,C.Nt,m.Fj,m.Q7,m.JJ,m.u,r.H8,h.lW,r.ZT,u.O5,g.Hw],styles:[""]}),i})();var M=c(1683);function w(i,n){1&i&&t._UZ(0,"mat-icon",20)}function D(i,n){1&i&&t._UZ(0,"mat-icon",21)}function A(i,n){1&i&&(t.TgZ(0,"th",22),t._uU(1," type_documents "),t.qZA())}function S(i,n){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.type_documents," ")}}function U(i,n){1&i&&(t.TgZ(0,"th",22),t._uU(1," No. "),t.qZA())}function Y(i,n){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.id," ")}}function I(i,n){1&i&&(t.TgZ(0,"th",22),t._uU(1," Libelle document "),t.qZA())}function N(i,n){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.libelle_document," ")}}function F(i,n){1&i&&(t.TgZ(0,"th",22),t._uU(1," Actions "),t.qZA())}function Q(i,n){1&i&&t._UZ(0,"mat-icon",20)}function k(i,n){1&i&&t._UZ(0,"mat-icon",28)}function J(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"td",24)(1,"div",3)(2,"button",25),t.NdJ("click",function(){const d=t.CHM(e).$implicit;return t.oxw().supprimerDocument(d)}),t._UZ(3,"mat-icon",26),t.qZA(),t.TgZ(4,"button",25),t.NdJ("click",function(){const d=t.CHM(e).$implicit;return t.oxw().imprimerDocument(d)}),t.YNc(5,Q,1,0,"mat-icon",6),t._uU(6," \xa0 "),t.YNc(7,k,1,0,"mat-icon",27),t.qZA()()()}if(2&i){const e=n.$implicit,o=t.oxw();t.xp6(5),t.Q6J("ngIf",o.data["btno"+e.id]),t.xp6(2),t.Q6J("ngIf",!o.data["btno"+e.id])}}function B(i,n){1&i&&(t.TgZ(0,"th",22),t._uU(1," Cr\xe9ation "),t.qZA())}function R(i,n){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.created_at,"dd/MM/YY")," ")}}function j(i,n){1&i&&t._UZ(0,"tr",29)}function H(i,n){1&i&&t._UZ(0,"tr",30)}let q=(()=>{class i{constructor(e,o,a,d){this._matDialog=e,this._fuseConfirmationService=o,this._snackBar=a,this._mediaService=d,this.dataSourceDocument=new l.by,this.displayedColumnsDocument=["no","libelle_document","created_at","actions"],this.data={}}ngOnInit(){this._updateDataSourceDocument()}_updateDataSourceDocument(){this._mediaService.getMediaByTypeAndId({type_documents:this.parent_typedocument,parent_id:this.parent_id}).subscribe(e=>{this.dataSourceDocument.data=e})}addDocument(){this.dialogRef=this._matDialog.open(T,{panelClass:"",data:{media:{type_documents:this.parent_typedocument,parent_id:this.parent_id}}}),this.dialogRef.afterClosed().subscribe(e=>{!e||this._updateDataSourceDocument()})}supprimerDocument(e){this.dialogRef=this._fuseConfirmationService.open({title:"Suppression de document",message:"Voulez-vous supprimer le document N\xb0 "+e.id+" ?"}),this.dialogRef.afterClosed().subscribe(o=>{"confirmed"===o&&this._mediaService.delete(e).subscribe(a=>{console.log(a),this._updateDataSourceDocument()})})}imprimerDocument(e){this.data["btno"+e.id]=!0,this._mediaService.getDocument(e.id).subscribe(o=>{window.open(URL.createObjectURL(new Blob(o)),"_blank"),this.data["btno"+e.id]=!1,this._snackBar.open("T\xe9l\xe9chargement termin\xe9","Splash",{horizontalPosition:"right",verticalPosition:"top",duration:2e3})},o=>{this.data["btno"+e.id]=!1})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.uw),t.Y36(M.R),t.Y36(f.ux),t.Y36(p))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-media"]],inputs:{parent_id:"parent_id",parent_typedocument:"parent_typedocument"},decls:30,vars:5,consts:[[1,"flex","flex-col","w-full","min-w-0"],[1,"mt-2","text-4xl","sm:text-2xl","font-extrabold","tracking-tight","leading-tight"],[1,"mt-2","sm:mt-2","pb-7","sm:p-6","sm:pb-7","shadow","rounded-2xl","bg-card","flex","flex-col"],[1,"flex"],[1,"w-full","pr-l","text-right"],["mat-button","",1,"h-6","min-h-6","px-2","text-sm","rounded-full","bg-hover","cursor-pointer","bg-red-900",3,"click"],["style","color: white;","svgIcon","iconsmind:refresh","class","animate-spin-slow",4,"ngIf"],["style","color: white;","svgIcon","iconsmind:add",4,"ngIf"],[1,"flex","flex-col","w-full"],["mat-table","","id","dvContainerdvContainer",1,"w-full",3,"dataSource"],["matColumnDef","type_documents"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","no"],["matColumnDef","libelle_document"],["matColumnDef","actions"],["mat-cell","","class","text-justify",4,"matCellDef"],["matColumnDef","created_at"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["svgIcon","iconsmind:refresh",1,"animate-spin-slow",2,"color","white"],["svgIcon","iconsmind:add",2,"color","white"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"text-justify"],["mat-icon-button","",1,"h-6","min-h-6","hidden","sm:inline-flex","ml-3",3,"click"],["svgIcon","heroicons_solid:x"],["svgIcon","heroicons_solid:printer",4,"ngIf"],["svgIcon","heroicons_solid:printer"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2," Documents "),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"button",5),t.NdJ("click",function(){return o.addDocument()}),t.YNc(7,w,1,0,"mat-icon",6),t._uU(8," \xa0 "),t.YNc(9,D,1,0,"mat-icon",7),t._uU(10," \xa0 "),t.qZA()()(),t.TgZ(11,"div",8)(12,"table",9),t.ynx(13,10),t.YNc(14,A,2,0,"th",11),t.YNc(15,S,2,1,"td",12),t.BQk(),t.ynx(16,13),t.YNc(17,U,2,0,"th",11),t.YNc(18,Y,2,1,"td",12),t.BQk(),t.ynx(19,14),t.YNc(20,I,2,0,"th",11),t.YNc(21,N,2,1,"td",12),t.BQk(),t.ynx(22,15),t.YNc(23,F,2,0,"th",11),t.YNc(24,J,8,2,"td",16),t.BQk(),t.ynx(25,17),t.YNc(26,B,2,0,"th",11),t.YNc(27,R,3,4,"td",12),t.BQk(),t.YNc(28,j,1,0,"tr",18),t.YNc(29,H,1,0,"tr",19),t.qZA()()()()),2&e&&(t.xp6(7),t.Q6J("ngIf",o.data.btnadd),t.xp6(2),t.Q6J("ngIf",!o.data.btnadd),t.xp6(3),t.Q6J("dataSource",o.dataSourceDocument),t.xp6(16),t.Q6J("matHeaderRowDef",o.displayedColumnsDocument),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumnsDocument))},directives:[h.lW,u.O5,g.Hw,l.BZ,l.w1,l.fO,l.ge,l.Dz,l.ev,l.as,l.XQ,l.nj,l.Gk],pipes:[u.uU],styles:[".mat-column-actions[_ngcontent-%COMP%]{width:20%}"]}),i})()}}]);