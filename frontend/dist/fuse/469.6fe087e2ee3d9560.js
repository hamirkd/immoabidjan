"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[469],{95:(p,m,r)=>{r.d(m,{L:()=>l});var s=r(5e3);let l=(()=>{class c{transform(_,...d){return"number"!=typeof _?_:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF",minimumFractionDigits:0,maximumFractionDigits:0}).format(_)}}return c.\u0275fac=function(_){return new(_||c)},c.\u0275pipe=s.Yjl({name:"currencyCFA",type:c,pure:!0}),c})()},758:(p,m,r)=>{r.d(m,{H:()=>l});var s=r(5e3);let l=(()=>{class c{transform(_,...d){return"number"!=typeof _?_:new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(_)}}return c.\u0275fac=function(_){return new(_||c)},c.\u0275pipe=s.Yjl({name:"currency",type:c,pure:!0}),c})()},7469:(p,m,r)=>{r.d(m,{z:()=>j});var s=r(4999),l=r(5166),c=r(5103),t=r(5e3),_=r(4521),d=r(8966),h=r(1683),g=r(7261),v=r(1200),C=r(8951),x=r(2057),f=r(9808),T=r(7423),Z=r(5245),b=r(7238),E=r(95),D=r(758);function A(e,o){if(1&e&&(t.TgZ(0,"div",28)(1,"label",29),t._uU(2,"Montant : "),t.qZA(),t.TgZ(3,"label",12),t._uU(4),t.ALo(5,"currencyCFA"),t.qZA()()),2&e){const n=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,1,n.acquisition.montant))}}function I(e,o){if(1&e&&(t.TgZ(0,"div",28)(1,"label",29),t._uU(2,"Montant : "),t.qZA(),t.TgZ(3,"label",12),t._uU(4),t.ALo(5,"currencyCFA"),t.qZA()()),2&e){const n=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,1,n.montant_verse))}}function S(e,o){1&e&&(t.TgZ(0,"label",29),t._uU(1,"Reste \xe0 payer : "),t.qZA())}function U(e,o){if(1&e&&(t.TgZ(0,"label",12),t._uU(1),t.ALo(2,"currencyCFA"),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,n.acquisition.montant-n.montant_verse))}}function y(e,o){1&e&&t._UZ(0,"mat-icon",30)}function M(e,o){1&e&&t._UZ(0,"mat-icon",31)}function O(e,o){1&e&&t._UZ(0,"mat-icon",30)}function w(e,o){1&e&&t._UZ(0,"mat-icon",32)}function P(e,o){1&e&&(t.TgZ(0,"th",33),t._uU(1," No. "),t.qZA())}function V(e,o){if(1&e&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.id," ")}}function R(e,o){1&e&&(t.TgZ(0,"th",33),t._uU(1," Montant "),t.qZA())}function Y(e,o){if(1&e&&(t.TgZ(0,"td",34),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n.montant)," ")}}function N(e,o){1&e&&(t.TgZ(0,"th",33),t._uU(1," Cr\xe9ation "),t.qZA())}function q(e,o){if(1&e&&(t.TgZ(0,"td",34),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,n.created_at,"dd/MM/YY")," ")}}function B(e,o){1&e&&(t.TgZ(0,"th",33),t._uU(1," Actions "),t.qZA())}function L(e,o){if(1&e&&(t.TgZ(0,"span",38),t._uU(1,"annul\xe9"),t.qZA()),2&e){const n=t.oxw().$implicit;t.hYB("matTooltip","",n.motif," [",n.cancelled_at,"]")}}function F(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().$implicit;return t.oxw().restorer(a)}),t._UZ(1,"mat-icon",40),t.qZA()}}function J(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().$implicit;return t.oxw().annuler(a)}),t._UZ(1,"mat-icon",41),t.qZA()}}function Q(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().$implicit;return t.oxw().supprimer2(a)}),t._UZ(1,"mat-icon",42),t.qZA()}}function W(e,o){if(1&e&&(t.TgZ(0,"td",35),t.YNc(1,L,2,2,"span",36),t.YNc(2,F,2,0,"button",37),t.YNc(3,J,2,0,"button",37),t.YNc(4,Q,2,0,"button",37),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.Q6J("ngIf",n.cancelled_at),t.xp6(1),t.Q6J("ngIf",n.cancelled_at),t.xp6(1),t.Q6J("ngIf",!n.cancelled_at),t.xp6(1),t.Q6J("ngIf",n.cancelled_at)}}function K(e,o){1&e&&t._UZ(0,"tr",43)}function H(e,o){1&e&&t._UZ(0,"tr",44)}let j=(()=>{class e{constructor(n,i,a,u,k,$,z){this.route=n,this._matDialog=i,this._fuseConfirmationService=a,this._snackBar=u,this._projetService=k,this._authService=$,this._versementService=z,this.dataSourceversement=new s.by,this.displayedColumnsversement=["id","montant","createdAt","actions"],this.data={},this.montant_verse=0}ngOnInit(){this.getHistoriqueVersement()}addVersement(){console.log(this.acquisition),this.dialogRef=this._matDialog.open(l.s,{panelClass:"",data:{versement:Object.assign(Object.assign({},this.acquisition),{id:0})}}),this.dialogRef.afterClosed().subscribe(n=>{!n||this.getHistoriqueVersement()})}getHistoriqueVersement(){this._versementService.getByDataFilter({acquisition_id:"",projet_id:this._projetService.projet.id}).subscribe(n=>{this.dataSourceversement.data=n,this.montant_verse=0,this.dataSourceversement.data.forEach(i=>{this.montant_verse=this.montant_verse+i.montant})},n=>{this.dataSourceversement.data=[],console.log(n)})}restorer(n){this.dialogRef=this._fuseConfirmationService.open({title:"Restauration de versement",message:"Voulez-vous restaurer le versement N "+n.id+" ?"}),this.dialogRef.afterClosed().subscribe(i=>{"confirmed"===i&&this._versementService.restore({id:n.id}).subscribe(a=>{console.log(a),this.getHistoriqueVersement()})})}annuler(n){this.dialogRef=this._matDialog.open(c.H,{data:{id:n.id}}),this.dialogRef.afterClosed().subscribe(i=>{!i||(console.log(i),this._versementService.cancelle(i).subscribe(a=>{this.getHistoriqueVersement(),console.log(a)},a=>{console.log(a)}))})}supprimer2(n){this.dialogRef=this._fuseConfirmationService.open({title:"Suppression de versement",message:"Voulez-vous supprimer le versement N "+n.id+" ?"}),this.dialogRef.afterClosed().subscribe(i=>{"confirmed"===i&&this._versementService.delete(n).subscribe(a=>{console.log(a),this.getHistoriqueVersement()})})}downloadInvoice(){}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(_.gz),t.Y36(d.uw),t.Y36(h.R),t.Y36(g.ux),t.Y36(v.Z),t.Y36(C.e),t.Y36(x._))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-versement-short"]],inputs:{acquisition:"acquisition"},decls:42,vars:11,consts:[[1,"flex","flex-col","w-full","min-w-0"],[1,"mt-2","text-4xl","sm:text-2xl","font-extrabold","tracking-tight","leading-tight"],[1,"flex","flex-col","w-full","mt-8","sm:mt-2","pb-0","sm:p-10","sm:pt-1","sm:pb-0","shadow","rounded-2xl","bg-card","mb-6"],[1,"flex","flex-col","w-full"],[1,"flex","pt-2"],[1,"w-1/2","pr-2"],["class","w-1/2 pr-l text-center",4,"ngIf"],[1,"w-1/2","pr-l","text-right"],["class","w-1/2 font-bold",4,"ngIf"],["class","w-1/2",4,"ngIf"],[1,"flex","w-1/2","pr-l","text-right"],[1,"w-2/3"],[1,"w-1/2"],["mat-button","",1,"h-6","min-h-6","px-2","rounded-full","bg-hover","cursor-pointer","bg-primary-900",3,"click"],["style","color: white;","svgIcon","iconsmind:refresh","class","animate-spin-slow",4,"ngIf"],["style","color: white;","svgIcon","iconsmind:printer",4,"ngIf"],["style","color: white;","svgIcon","iconsmind:add",4,"ngIf"],[1,"flex"],["mat-table","","id","dvContainerdvContainer",1,"w-full",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","montant"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-cell","","class","text-justify","style","align-items: center;",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"w-1/2","pr-l","text-center"],[1,"w-1/2","font-bold"],["svgIcon","iconsmind:refresh",1,"animate-spin-slow",2,"color","white"],["svgIcon","iconsmind:printer",2,"color","white"],["svgIcon","iconsmind:add",2,"color","white"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"text-justify",2,"align-items","center"],["class","shadow rounded-2xl overflow-hidden pr-2 pl-2 bg-card  bg-primary-900 text-white",3,"matTooltip",4,"ngIf"],["class","hidden sm:inline-flex ml-3","mat-icon-button","",3,"click",4,"ngIf"],[1,"shadow","rounded-2xl","overflow-hidden","pr-2","pl-2","bg-card","bg-primary-900","text-white",3,"matTooltip"],["mat-icon-button","",1,"hidden","sm:inline-flex","ml-3",3,"click"],["svgIcon","restore"],["svgIcon","heroicons_solid:ban",1,"text-primary-900"],["svgIcon","cancel",1,"text-primary-900"],["mat-header-row",""],["mat-row",""]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2," Versement "),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"div",4),t._UZ(6,"div",5),t.YNc(7,A,6,3,"div",6),t.YNc(8,I,6,3,"div",6),t.TgZ(9,"div",7),t.YNc(10,S,2,0,"label",8),t.YNc(11,U,3,3,"label",9),t.qZA(),t.TgZ(12,"div",10),t._UZ(13,"div",11),t.TgZ(14,"div",12)(15,"button",13),t.NdJ("click",function(){return i.downloadInvoice()}),t.YNc(16,y,1,0,"mat-icon",14),t._uU(17," \xa0 "),t.YNc(18,M,1,0,"mat-icon",15),t._uU(19," \xa0 "),t.qZA()(),t.TgZ(20,"div",12)(21,"button",13),t.NdJ("click",function(){return i.addVersement()}),t.YNc(22,O,1,0,"mat-icon",14),t._uU(23," \xa0 "),t.YNc(24,w,1,0,"mat-icon",16),t._uU(25," \xa0 "),t.qZA()()()()(),t.TgZ(26,"div",17)(27,"table",18),t.ynx(28,19),t.YNc(29,P,2,0,"th",20),t.YNc(30,V,2,1,"td",21),t.BQk(),t.ynx(31,22),t.YNc(32,R,2,0,"th",20),t.YNc(33,Y,3,3,"td",21),t.BQk(),t.ynx(34,23),t.YNc(35,N,2,0,"th",20),t.YNc(36,q,3,4,"td",21),t.BQk(),t.ynx(37,24),t.YNc(38,B,2,0,"th",20),t.YNc(39,W,5,4,"td",25),t.BQk(),t.YNc(40,K,1,0,"tr",26),t.YNc(41,H,1,0,"tr",27),t.qZA()()()()),2&n&&(t.xp6(7),t.Q6J("ngIf",i.acquisition.acquisition_id),t.xp6(1),t.Q6J("ngIf",!i.acquisition.acquisition_id),t.xp6(2),t.Q6J("ngIf",i.acquisition.acquisition_id),t.xp6(1),t.Q6J("ngIf",i.acquisition.acquisition_id),t.xp6(5),t.Q6J("ngIf",i.data.btnprinter),t.xp6(2),t.Q6J("ngIf",!i.data.btnprinter),t.xp6(4),t.Q6J("ngIf",i.data.btnadd),t.xp6(2),t.Q6J("ngIf",!i.data.btnadd),t.xp6(3),t.Q6J("dataSource",i.dataSourceversement),t.xp6(13),t.Q6J("matHeaderRowDef",i.displayedColumnsversement),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumnsversement))},directives:[f.O5,T.lW,Z.Hw,s.BZ,s.w1,s.fO,s.ge,s.Dz,s.ev,b.gM,s.as,s.XQ,s.nj,s.Gk],pipes:[E.L,D.H,f.uU],styles:[".mat-column-actions[_ngcontent-%COMP%]{width:20%}"]}),e})()}}]);